workflows:
  ios-workflow:
    name: "iOS Workflow"
    environment:
      flutter: stable
      xcode: latest
      groups:
        - "Nicholas Cooke"
    scripts:
      - name: "Precache & Install Pods"
        script: |
          flutter precache --ios
          flutter pub get
          cd ios
          pod install
          cd ..
      - name: "Build iOS Release"
        script: |
          flutter build ipa --release

    artifacts:
      - build/ios/ipa/*.ipa

    publishing:
      app_store_connect:
        # Instead of 'inherit: true', define it directly:
        api_key:
          key_id: $APP_STORE_CONNECT_KEY_ID
          issuer_id: $APP_STORE_CONNECT_ISSUER_ID
          private_key: $APP_STORE_CONNECT_PRIVATE_KEY
        export_method: app-store

# OPTIONAL: You only need top-level code_signing if you want to 'inherit' from there.
# code_signing:
#   app_store_connect:
#     key_id: $APP_STORE_CONNECT_KEY_ID
#     issuer_id: $APP_STORE_CONNECT_ISSUER_ID
#     private_key: $APP_STORE_CONNECT_PRIVATE_KEY
#   xcode_project:
#     automatic_code_signing: true
#     bundle_id: "com.ragtag.ragtag"
